<section class="relative w-full py-[100px] overflow-hidden">
 <div class="w-full pl-6 lg:pl-12 flex flex-col lg:flex-row items-start gap-10 relative">

    <!-- Left Side -->
    <div class="w-full lg:w-1/3 pl-20 text-center lg:text-left relative z-1">
      <h4 class="!text-[18px] tracking-[2px] font-light uppercase">Loyal Coffee Drinkers</h4>
      <h2 class="!text-[24px] font-extrabold text-[#7B2D26] tracking-wide">Say It Best</h2>

      <!-- Nav Arrows -->
      <div class="flex justify-center lg:justify-start gap-6 mt-6">
        <button id="prevBtn" class="text-3xl lg:text-5xl font-bold text-gray-800 hover:text-[#7B2D26] transition">
          &lt;
        </button>
        <button id="nextBtn" class="text-3xl lg:text-5xl font-bold text-gray-800 hover:text-[#7B2D26] transition">
          &gt;
        </button>
      </div>
    </div>

    <!-- Right Side (Testimonial Box) -->
    <div class="w-full lg:w-2/3 bg-black text-white px-8 py-12 rounded-l-[2rem] rounded-r-none relative z-1">
    <span class="text-6xl text-yellow-500">â€œ</span>
   <p id="testimonialText" class="text-[18px] leading-relaxed transition-opacity duration-500 opacity-100">
  {{ section.blocks[0].settings.review_text }}
</p>
<p id="testimonialAuthor" class="mt-4 font-bold text-[20px] transition-opacity duration-500 opacity-100">
  {{ section.blocks[0].settings.reviewer_name }}
</p>

    </div>


    <!-- Coffee Image (absolute near testimonial) -->
    {% if section.settings.coffee_image != blank %}
      <img height="" width=""
        src="{{ section.settings.coffee_image | image_url }}" 
        alt="coffee" 
        class="w-[300px] absolute -bottom-50 left-60 lg:w-[428px] z-2"
      >
    {% endif %}
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const testimonials = [
  {% for block in section.blocks %}
    {
      text: `{{ block.settings.review_text | escape | strip_newlines }}`,
      author: `{{ block.settings.reviewer_name | escape }}`
    }{% unless forloop.last %},{% endunless %}
  {% endfor %}
];


    let currentIndex = 0;
    const textEl = document.getElementById("testimonialText");
    const authorEl = document.getElementById("testimonialAuthor");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    function updateTestimonial(index) {
      textEl.classList.add("opacity-0");
      authorEl.classList.add("opacity-0");

      setTimeout(() => {
        textEl.textContent = testimonials[index].text;
        authorEl.textContent = testimonials[index].author;

        textEl.classList.remove("opacity-0");
        authorEl.classList.remove("opacity-0");
      }, 300);
    }

    prevBtn.addEventListener("click", () => {
      currentIndex = (currentIndex - 1 + testimonials.length) % testimonials.length;
      updateTestimonial(currentIndex);
    });

    nextBtn.addEventListener("click", () => {
      currentIndex = (currentIndex + 1) % testimonials.length;
      updateTestimonial(currentIndex);
    });
  });
</script>

{% schema %}
{
  "name": "Testimonial Slider",
  "settings": [
    {
      "type": "image_picker",
      "id": "coffee_image",
      "label": "Coffee Image"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "review_text",
          "label": "Review Text",
          "default": "We love this coffee... amazing taste without bitterness!"
        },
        {
          "type": "text",
          "id": "reviewer_name",
          "label": "Reviewer Name",
          "default": "John D."
        }
      ]
    }
  ],
  "max_blocks": 10,
  "presets": [
    {
      "name": "Testimonial Slider",
      "category": "Testimonials",
      "blocks": [
        { "type": "testimonial" },
        { "type": "testimonial" }
      ]
    }
  ]
}
{% endschema %}
