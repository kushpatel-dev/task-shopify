<section id="coffee-hero-{{ section.id }}" class="relative w-full overflow-hidden coffee-hero-slider">
  <div class="relative h-[90vh] min-h-[560px] w-full">
    <div class="slides relative h-full w-full">
      {% for block in section.blocks %}
        {% assign bg = block.settings.bg_image %}
        <div
          class="slide absolute inset-0 opacity-0 pointer-events-none transition-opacity duration-700 ease-out"
          data-index="{{ forloop.index0 }}"
          role="group"
          aria-roledescription="slide"
          aria-label="Slide {{ forloop.index }} of {{ section.blocks.size }}"
          {{ block.shopify_attributes }}>
          <div class="absolute inset-0 ">
            {% if bg != blank %}
              {% comment %}Eager-load first slide for LCP, lazy others{% endcomment %}
              <img
                height=""
                width=""
                src="{{ bg | image_url: width: 2880 }}"
                alt=""
                class="h-full w-full object-cover brightness-40"
                {% if forloop.first %}
                loading="eager"
                fetchpriority="high"
                {% else %}
                loading="lazy"
                {% endif %}>
            {% else %}
              <div class="h-full w-full bg-neutral-800"></div>
            {% endif %}

            {% if block.settings.overlay_tint == 'dark' %}
              <div class="absolute inset-0 bg-black/45"></div>
            {% endif %}
          </div>

          <div class="relative z-0 flex h-full w-full items-center justify-center px-4">
            <div class="max-w-5xl text-center">
              {% assign icon = section.settings.coffee_icon %}
              <div class="mb-6 flex justify-center">
                {% if icon != blank %}
                  <img
                    height=""
                    width=""
                    src="{{ icon | image_url: width: 160 }}"
                    alt=""
                    class="h-10 w-10 object-contain">
                {% else %}
                  <span class="inline-block h-10 w-10 rounded-full bg-white/90" aria-hidden="true"></span>
                {% endif %}
              </div>

              {% assign h1 = block.settings.heading_line1 | escape %}
              {% assign h2 = block.settings.heading_line2 | escape %}
              <p class="text-white tracking-[0.05em] text-[28px] leading-tight md:text-[36px] font-normal">{{ h1 }}</p>
              <p class="text-white tracking-[0.05em] text-[28px] leading-tight md:text-[36px] font-normal mb-2">{{ h2 }}</p>

              <h2 class="uppercase" style="font-family: subway-novella; font-weight: 400; letter-spacing: 0.05em;">
                <span class="text-white block text-[56px] leading-none md:text-[84px] lg:text-[100px]">
                  {{ block.settings.heading_big | escape }}
                </span>
              </h2>

              {% if block.settings.subtext != blank %}
                <p class="mx-auto mt-4 max-w-3xl text-white/95" style="font-family: var(--coffee-hero-oxygen); font-weight: 400; letter-spacing: 0.03em; line-height: 1.2; font-size: 18px;">
                  <span class="block md:text-[22px] lg:text-[28px]">{{ block.settings.subtext }}</span>
                </p>
              {% endif %}

              {% assign cta_label = block.settings.cta_label | default: section.settings.primary_cta_label | default: 'Shop Now' %}
              {% assign cta_link = block.settings.cta_link | default: section.settings.primary_cta_link %}
              {% if cta_link != blank %}
                <div class="mt-8">
                  <a
                    href="{{ cta_link }}"
                    class="inline-flex items-center justify-center rounded-full bg-[#d89a3c] px-8 py-3 text-white hover:bg-[#c5872f] transition shadow focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#d89a3c]"
                    aria-label="{{ cta_label }}">
                    {{ cta_label }}
                  </a>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>

    <!-- Previous Button -->
    <button
      type="button"
      class="nav prev absolute left-4 top-1/2 -translate-y-1/2 z-20 grid h-12 w-12 place-items-center "
      aria-label="Previous slide">
      {% if section.settings.prev_icon != blank %}
        <img
          height=""
          width=""
          src="{{ section.settings.prev_icon | img_url: 'master' }}"
          alt="Previous"
          class="h-6 w-6">
      {% endif %}
    </button>

    <!-- Next Button -->
    <button
      type="button"
      class="nav next absolute right-4 top-1/2 -translate-y-1/2 z-20 grid h-12 w-12 place-items-center "
      aria-label="Next slide">
      {% if section.settings.next_icon != blank %}
        <img
          height=""
          width=""
          src="{{ section.settings.next_icon | img_url: 'master' }}"
          alt="Next"
          class="h-6 w-6">
      {% endif %}
    </button>

    <!-- Dots -->
    <div
      class="dots absolute bottom-6 left-1/2 z-0 -translate-x-1/2 flex items-center gap-3"
      role="tablist"
      aria-label="Slide navigation"></div>
  </div>
</section>

{% stylesheet %}
  :root  {
    --coffee-hero-fjord: 'Fjord'
    , ui-serif
    , Georgia
    , serif;
    --coffee-hero-oxygen: 'Oxygen'
    , ui-sans-serif
    , system-ui
    , -apple-system
    , Segoe UI
    , Roboto
    , Helvetica
    , Arial
    , "Apple Color Emoji"
    , "Segoe UI Emoji";
  }
  /* Fjord and Oxygen webfonts */
  @font-face {
    font-family: 'Fjord';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url("https://fonts.gstatic.com/s/fjordone/v17/zOL64pLDlL1D99S8g8PtiKchq-dmjQ.woff2") format("woff2");
  }
  @font-face {
    font-family: 'Oxygen';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url("https://fonts.gstatic.com/s/oxygen/v15/2sDdZGNfip_eirT0yCm8zJY.woff2") format("woff2");
  }
{% endstylesheet %}

{% javascript %}
  (() => {
    const root = document.querySelector('.coffee-hero-slider');
    if (! root) return;
    


// Get values from data attributes
    const autoplaySec = parseInt(root.dataset.autoplay, 10) || 0;
    const pauseOnHover = root.dataset.pause === 'true';

    const slides = Array.from(root.querySelectorAll('.slide'));
    const dotsWrap = root.querySelector('.dots');
    const prevBtn = root.querySelector('.nav.prev');
    const nextBtn = root.querySelector('.nav.next');

// No slides case
    if (! slides.length) {
      prevBtn ?. classList.add('hidden');
      nextBtn ?. classList.add('hidden');
      dotsWrap ?. classList.add('hidden');
      return;
    }

// Only one slide
    if (slides.length === 1) {
      slides[0].style.opacity = '1';
      slides[0].style.pointerEvents = 'auto';
      prevBtn ?. classList.add('hidden');
      nextBtn ?. classList.add('hidden');
      dotsWrap ?. classList.add('hidden');
      return;
    }

// Build dots
    slides.forEach((_, i) => {
      const b = document.createElement('button');
      b.type = 'button';
      b.className = 'h-3 w-3 rounded-full bg-yellow-400/50 hover:bg-yellow-400 transition outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-400';
      b.setAttribute('aria-label', 'Go to slide ' + (
        i + 1
      ));
      b.setAttribute('role', 'tab');
      b.dataset.index = String(i);
      dotsWrap.appendChild(b);
    });
    const dots = Array.from(dotsWrap.querySelectorAll('button'));

    let index = 0;
    let timer = null;

    const setActive = (i) => {
      index = (i + slides.length) % slides.length;
      slides.forEach((s, k) => {
        const isActive = k === index;
        s.style.opacity = isActive
          ? '1'
          : '0';
        s.style.pointerEvents = isActive
          ? 'auto'
          : 'none';
        s.setAttribute(
          'aria-hidden',
          isActive
            ? 'false'
            : 'true'
        );
      });
      dots.forEach((d, k) => {
        const isActive = k === index;
        d.style.backgroundColor = isActive
          ? 'rgb(234 179 8)'
          : 'rgba(234,179,8,0.5)';
        d.style.transform = isActive
          ? 'scale(1.15)'
          : 'scale(1)';
        d.setAttribute(
          'aria-selected',
          isActive
            ? 'true'
            : 'false'
        );
        d.setAttribute(
          'aria-current',
          isActive
            ? 'true'
            : 'false'
        );
        d.tabIndex = isActive
          ? 0
          : -1;
      });
    };

    const next = () => setActive(index + 1);
    const prev = () => setActive(index - 1);

// Init
    setActive(0);
    nextBtn.addEventListener('click', next);
    prevBtn.addEventListener('click', prev);
    dots.forEach(d => d.addEventListener('click', () => setActive(parseInt(d.dataset.index, 10))));

// Keyboard support
    root.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight') 
        next();
      


      if (e.key === 'ArrowLeft') 
        prev();
      


    });

// Autoplay
    const start = () => {
      if (! autoplaySec || autoplaySec < 1) return;
      


      stop();
      timer = setInterval(next, autoplaySec * 1000);
    };
    const stop = () => {
      if (timer) {
        clearInterval(timer);
        timer = null;
      }
    };
    start();

    if (pauseOnHover && autoplaySec) {
      root.addEventListener('mouseenter', stop);
      root.addEventListener('mouseleave', start);
    }
  })();
{% endjavascript %}


{% schema %}
  {
    "name": "Coffee Hero Slider",
    "tag": "section",
    "class": "coffee-hero-slider",
    "settings": [
      {
        "type": "image_picker",
        "id": "coffee_icon",
        "label": "Coffee bean icon",
        "info": "Shown above headline"
      },
      {
        "type": "url",
        "id": "primary_cta_link",
        "label": "Default CTA link",
        "info": "Used if a slide does not override"
      },
      {
        "type": "text",
        "id": "primary_cta_label",
        "label": "Default CTA label",
        "default": "Shop Now"
      },
      {
        "type": "image_picker",
        "id": "prev_icon",
        "label": "Previous Button Icon"
      }, {
        "type": "image_picker",
        "id": "next_icon",
        "label": "Next Button Icon"
      }, {
        "type": "range",
        "id": "auto_play_seconds",
        "label": "Autoplay seconds (0 = off)",
        "min": 0,
        "max": 15,
        "step": 1,
        "default": 0
      }, {
        "type": "checkbox",
        "id": "pause_on_hover",
        "label": "Pause on hover",
        "default": true
      }
    ],
    "blocks": [
      {
        "type": "slide",
        "name": "Slide",
        "settings": [
          {
            "type": "image_picker",
            "id": "bg_image",
            "label": "Background image"
          },
          {
            "type": "text",
            "id": "heading_line1",
            "label": "Heading line 1",
            "default": "COFFEE HAS"
          },
          {
            "type": "text",
            "id": "heading_line2",
            "label": "Heading line 2",
            "default": "NEVER TASTED"
          },
          {
            "type": "text",
            "id": "heading_big",
            "label": "Big text",
            "default": "THIS GOOD"
          }, {
            "type": "text",
            "id": "subtext",
            "label": "Paragraph",
            "default": "Even the best roasting process is useless without premium quality beans — and at Don Pablo Coffee, ours are unmatched."
          }, {
            "type": "url",
            "id": "cta_link",
            "label": "CTA link (optional)"
          }, {
            "type": "text",
            "id": "cta_label",
            "label": "CTA label (optional)"
          }, {
            "type": "select",
            "id": "overlay_tint",
            "label": "Overlay tint",
            "default": "dark",
            "options": [
              {
                "value": "dark",
                "label": "Dark"
              }, {
                "value": "none",
                "label": "None"
              }
            ]
          }
        ]
      }
    ],
    "max_blocks": 8,
    "presets": [
      {
        "name": "Coffee Hero Slider",
        "category": "Image",
        "blocks": [
          {
            "type": "slide"
          }, {
            "type": "slide"
          }, {
            "type": "slide"
          }
        ]
      }
    ]
  }
{% endschema %}