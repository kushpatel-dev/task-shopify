{% style %}
  .timeline-horizontal-line::before,
  .timeline-horizontal-line::after {
    content: '';
    position: absolute;
    width: 1rem;
    /* 16px */
    height: 1rem;
    /* 16px */
    border-radius: 9999px;
    /* Make it a perfect circle */
    background-color: {{ section.settings.line_color }};
    top: 50%;
    transform: translateY(-50%);
    z-index: 5;
  }
  .timeline-horizontal-line::before {
    left: 0;
  }
  .timeline-horizontal-line::after {
    right: 0;
  }
{% endstyle %}

<div class="py-12 lg:py-24 overflow-hidden" style="background-color: {{ section.settings.bg_color }};">
  <div class="max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center">
      <h3 class="text-sm font-bold tracking-widest uppercase" style="color: {{ section.settings.subheading_color }};">
        {{ section.settings.section_subheading }}
      </h3>
      <h2 class="mt-4 text-4xl md:text-5xl font-bold" style="color: {{ section.settings.heading_color }};">
        {{ section.settings.section_heading }}
      </h2>
    </div>

    {% if section.blocks.size > 0 %}
      <div class="mt-24">
        <!-- Desktop Layout: Alternating Timeline -->
        <div class="relative">
          <!-- Horizontal timeline line with a class for CSS targeting -->
          <div class="timeline-horizontal-line absolute top-1/2 left-0 w-full h-0.5" style="background-color: {{ section.settings.line_color }};"></div>

          <div class="relative flex justify-between">
            {% for block in section.blocks %}
              {% assign is_odd_index = forloop.index | modulo: 2 %}
              <div class="w-1/{{ section.blocks.size }} flex justify-center">
                <div class="flex items-center {% if is_odd_index == 0 %}flex-col-reverse{% else %}flex-col{% endif %}">
                  <!-- Text content -->
                  <div class="text-center px-4 relative h-48 w-full flex items-center {% if is_odd_index == 0 %}mt-6 pt-10 border-t-2{% else %}mb-4 pb-0 border-b-2{% endif %}" style="border-color: {{ section.settings.line_color }};">
                    <!-- Vertical Connector Line -->
                    <div class="absolute left-1/2 -translate-x-1/2 w-0.5 h-12 {% if is_odd_index == 1 %}bottom-0{% else %}top-0{% endif %}" style="background-color: {{ section.settings.line_color }};"></div>
                    {% if is_odd_index == 0 %}
                      <!-- Content for Items on Top -->
                      <div class="text-left w-full">
                        <p class="text-2xl font-medium" style="color: {{ section.settings.number_color }};">{{ block.settings.step_number }}</p>
                        <h3 class="text-xl font-semibold mt-1" style="color: {{ section.settings.heading_color }};">{{ block.settings.title }}</h3>
                        <p class="text-sm mt-2" style="color: {{ section.settings.text_color }};">{{ block.settings.description }}</p>
                      </div>
                    {% else %}
                      <!-- Content for Items on Bottom -->
                      <div class="relative text-left w-full">
                        <h3 class="text-xl font-semibold" style="color: {{ section.settings.heading_color }};">{{ block.settings.title }}</h3>
                        <p class="text-sm mt-2" style="color: {{ section.settings.text_color }};">{{ block.settings.description }}</p>
                        <p class="text-2xl font-medium mt-1" style="color: {{ section.settings.number_color }};">{{ block.settings.step_number }}</p>
                      </div>
                    {% endif %}
                  </div>

                  <!-- Icon -->
                  <div class="relative z-10 w-[100px] h-[103px] flex items-center justify-center rounded-lg" style="background-color: {{ section.settings.icon_bg_color }};">
                    {% if block.settings.icon != blank %}
                      <img
                        src="{{ block.settings.icon | image_url: width: 64 }}"
                        alt="{{ block.settings.title | escape }}"
                        width="64"
                        height="64"
                        loading="lazy"
                        class="w-[50px] h-[50px]">
                    {% else %}
                      <div class="w-16 h-16 bg-gray-300 rounded"></div>
                    {% endif %}
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
  {
    "name": "Process Timeline",
    "settings": [
      {
        "type": "text",
        "id": "section_subheading",
        "label": "Section Subheading",
        "default": "OUR PROCESS"
      },
      {
        "type": "text",
        "id": "section_heading",
        "label": "Section Heading",
        "default": "Project Implementation Process"
      },
      {
        "type": "header",
        "content": "Color Settings"
      },
      {
        "type": "color",
        "id": "bg_color",
        "label": "Background Color",
        "default": "#F9FAFB"
      }, {
        "type": "color",
        "id": "subheading_color",
        "label": "Subheading Color",
        "default": "#878E88"
      }, {
        "type": "color",
        "id": "heading_color",
        "label": "Heading & Title Color",
        "default": "#111827"
      }, {
        "type": "color",
        "id": "text_color",
        "label": "Description Text Color",
        "default": "#6B7280"
      }, {
        "type": "color",
        "id": "number_color",
        "label": "Step Number Color",
        "default": "#008060"
      }, {
        "type": "color",
        "id": "icon_bg_color",
        "label": "Icon Background Color",
        "default": "#D1D5DB"
      }, {
        "type": "color",
        "id": "line_color",
        "label": "Timeline Line Color",
        "default": "#D1D5DB"
      }
    ],
    "blocks": [
      {
        "type": "step",
        "name": "Process Step",
        "settings": [
          {
            "type": "image_picker",
            "id": "icon",
            "label": "Step Icon"
          }, {
            "type": "text",
            "id": "step_number",
            "label": "Step Number",
            "default": "01"
          }, {
            "type": "text",
            "id": "title",
            "label": "Step Title",
            "default": "Initial Consultation"
          }, {
            "type": "textarea",
            "id": "description",
            "label": "Step Description",
            "default": "We start by understanding your vision, goals, and requirements."
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Process Timeline",
        "category": "Custom Sections",
        "blocks": [
          {
            "type": "step"
          },
          {
            "type": "step"
          },
          {
            "type": "step"
          },
          {
            "type": "step"
          }, {
            "type": "step"
          }
        ]
      }
    ]
  }
{% endschema %}